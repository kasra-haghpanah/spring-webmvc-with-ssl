<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title th:text="${title}">title</title>
</head>

<!--
<link media="all" th:href="@{'/resource/'+${version}+'?path=css/upload-download.css'}" rel="stylesheet"/>
<script type="text/javascript" th:src="@{'/resource/'+${version}+'?path=js/html5.js'}"></script>
<script type="text/javascript" th:src="@{'/resource/'+${version}+'?path=js/upload-download.js'}"></script>
-->

<script type="application/javascript">

    const jwtToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."; // Ø§ÛŒÙ†Ùˆ Ø§Ø² login API Ø¨Ú¯ÛŒØ±

    // Ø§ØªØµØ§Ù„ Ø¨Ø§ ØªÙˆÚ©Ù† Ø¯Ø± query string
    const socket = new WebSocket(`ws://localhost:8080/ws?token=${jwtToken}`);

    socket.onopen = () => {
        logMessage("âœ… Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯");
    };

    socket.onmessage = (event) => {
        logMessage("ğŸ“© Ø¯Ø±ÛŒØ§ÙØª: " + event.data);
    };

    socket.onclose = () => {
        logMessage("âŒ Ø§ØªØµØ§Ù„ Ø¨Ø³ØªÙ‡ Ø´Ø¯");
    };

    socket.onerror = (error) => {
        logMessage("âš ï¸ Ø®Ø·Ø§: " + error.message);
    };

    function sendMessage() {
        const input = document.getElementById("messageInput");
        const msg = input.value;
        socket.send(msg);
        logMessage("ğŸ“¤ Ø§Ø±Ø³Ø§Ù„: " + msg);
        input.value = "";
    }

    function logMessage(msg) {
        const messagesDiv = document.getElementById("messages");
        const p = document.createElement("p");
        p.textContent = msg;
        messagesDiv.appendChild(p);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

</script>



<body>
<h2>Ø§Ø±ØªØ¨Ø§Ø· WebSocket Ø¨Ø§ JWT</h2>
<div>
    <input type="text" id="messageInput" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯">
    <button onclick="sendMessage()">Ø§Ø±Ø³Ø§Ù„</button>
</div>
<div id="messages"></div>



</body>

</html>